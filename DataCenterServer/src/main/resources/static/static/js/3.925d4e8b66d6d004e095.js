webpackJsonp([3],{"8Gjx":function(e,t,l){"use strict";l("4Zt/");var a=l("z/Aw"),i=l("zL8q"),s={name:"select_objAttr",props:{objs:Array},data:function(){return{objList:[],attrList:[],objAttr:{},checkedObiIndex:"",checkedAttr:[]}},created:function(){var e=this;this.objList=[],this.attrList=[],this.objs?this.objList=this.objs:a.a.getDataObjectsList({type:"对象",isDic:"",name:"",pageInfo:{page:0,pageSize:0}}).then(function(t){e.objList=t.data.list}).catch(function(e){console.log(e),i.Message.error("获取对象列表失败。",e)})},mounted:function(){},methods:{selectedName:function(e){for(var t=0;t<this.objList.length;t++){var l=this.objList[t];if(l.id==e)return l.name}},changeCheckedAttr:function(){var e=[];return console.log("this.checkedAttr",this.checkedAttr),this.checkedAttr.forEach(function(t,l){var a={};a.resId=t.split(",")[3],a.id=t.split(",")[2],e[l]=a}),e}},watch:{checkedObiIndex:function(e){var t=this;this.objAttr[e]||(this.attrList=[],a.a.getDataObjectAttrsList({resId:e,pageInfo:{page:0,pageSize:0}}).then(function(e){t.attrList=e.data.list}).catch(function(e){console.log(e),i.Message.error("获取属性列表失败。",e)}))},checkedAttr:function(e){var t=this.changeCheckedAttr();console.log("changeCheckedAttr()",t),this.$emit("listenDatasetAttrs",t)}}},o={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticStyle:{width:"100%",border:"1px solid #eee"}},[l("el-row",{attrs:{gutter:20}},[l("el-col",{attrs:{span:12}},[l("p",[e._v("浏览对象：")]),e._v(" "),l("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择浏览对象"},model:{value:e.checkedObiIndex,callback:function(t){e.checkedObiIndex=t},expression:"checkedObiIndex"}},e._l(this.objList,function(e,t){return l("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),e._v(" "),l("div",{staticStyle:{border:"1px solid #eee","margin-top":"10px",height:"150px","overflow-y":"auto"}},e._l(e.attrList,function(t,a){return l("p",{key:a},[l("el-checkbox",{attrs:{label:e.selectedName(t.resId)+","+t.name+","+t.id+","+t.resId},model:{value:e.checkedAttr,callback:function(t){e.checkedAttr=t},expression:"checkedAttr"}},[e._v(e._s(t.name))])],1)}))],1),e._v(" "),l("el-col",{staticStyle:{height:"200px","overflow-y":"auto"},attrs:{span:12}},[l("p",[e._v("选择对象：")]),e._v(" "),l("p",[l("label",{staticStyle:{display:"inline-block",width:"45%"}},[e._v("对象名称")]),e._v(" "),l("label",{staticStyle:{display:"inline-block",width:"45%"}},[e._v("属性名称")])]),e._v(" "),e._l(e.checkedAttr,function(t,a){return l("p",{key:a,staticStyle:{"margin-left":"10px"}},[l("label",{staticStyle:{display:"inline-block",width:"45%"}},[e._v(e._s(t.split(",")[0]))]),e._v(" "),l("el-checkbox",{staticStyle:{width:"45%"},attrs:{label:t},model:{value:e.checkedAttr,callback:function(t){e.checkedAttr=t},expression:"checkedAttr"}},[e._v(e._s(t.split(",")[1]))])],1)})],2)],1)],1)},staticRenderFns:[]},n=l("VU/8")(s,o,!1,null,null,null);t.a=n.exports},oyKc:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l("woOf"),i=l.n(a),s=(l("4Zt/"),l("z/Aw")),o=l("zL8q"),n={name:"viewdataset",components:{selectObjAttr:l("8Gjx").a},data:function(){return{headerTitle:"数据集属性列表",resId:"",viewTable:{domId:"",className:"",data:[]},viewAdd:{data:{resId:this.resId},show:!1},viewEdit:{index:"",data:{resId:this.resId},show:!1},viewDelet:{show:!1,data:{resId:this.resId},index:""},plugs:{select1:[{label:"varchar",value:"varchar"},{label:"char",value:"char"},{label:"tinyint",value:"tinyint"},{label:"smallint",value:"smallint"},{label:"mediumint",value:"mediumint"},{label:"integer",value:"integer"},{label:"bigint",value:"bigint"},{label:"float",value:"float"},{label:"double",value:"double"},{label:"decimal",value:"decimal"},{label:"tinytext",value:"tinytext"},{label:"text",value:"text"},{label:"mediumtext",value:"mediumtext"},{label:"longtext",value:"longtext"},{label:"tinyblog",value:"tinyblog"},{label:"blog",value:"blog"},{label:"mediumblog",value:"mediumblog"},{label:"longblog",value:"longblog"}],select2:[{label:"字典",value:"字典"},{label:"邮箱",value:"邮箱"},{label:"手机号",value:"手机号"},{label:"文本",value:"文本"},{label:"数字",value:"数字"},{label:"身份证",value:"身份证"}],select3:[]},_DatasetAttrs:[]}},created:function(){this.resId=parseInt(this.$route.path.split("/")[3]),this.handleSearch()},methods:{handleSearch:function(){var e=this;s.a.getDataObjectAttrsList({resId:this.resId,pageInfo:{page:0,pageSize:0}}).then(function(t){e.viewTable.data=t.data.list}).catch(function(e){console.log(e),o.Message.error(e)})},handleEdit:function(e,t){console.log("edit",e,t),this.viewEdit.data=i()({},e),this.viewEdit.data.resId=this.resId,this.viewEdit.index=t,this.viewEdit.show=!0},editSingle:function(){var e=this;s.a.editDataObjectAttr(this.viewEdit.data).then(function(t){(t.success=!0)&&(o.Message.success("修改成功"),e.handleSearch(),e.viewEdit.show=!1)}).catch(function(e){console.log(e),o.Message.error(e)})},handleDelet:function(e,t){console.log("delet",e),this.viewDelet.data=e,this.viewDelet.data.resId=this.resId,this.viewDelet.index=t,this.viewDelet.show=!0},deletSingle:function(){var e=this;s.a.deleteDataObjectAttr({id:this.viewDelet.data.id}).then(function(t){1==t.success&&(o.Message.success("删除成功"),e.handleSearch(),e.viewDelet.show=!1)}).catch(function(e){console.log(e),o.Message.error(e)})},handleAdd:function(e){this.viewAdd.show=!0},addSingle:function(){var e=this,t=this._DatasetAttrs;t.length<=0||(console.log("adddDatasetAttrs 接口",t),s.a.addDataObjectAttr({objectId:this.resId,list:t}).then(function(t){console.log("添加属性",t),1==t.success?(o.Message.success("添加数据集属性成功。"),e.viewAdd.show=!1,e.handleSearch()):o.Message.error("添加数据集属性失败。")}).catch(function(e){console.log("error",e.data.message),o.Message.error("添加数据集属性失败。"+e.data.message)}))},_getDatasetAttrs:function(e){console.log("_getDatasetAttrs",e),this._DatasetAttrs=e}}},r={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",[l("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[l("div",{staticClass:"breadxian"}),e._v(" "),l("el-breadcrumb-item",[e._v(e._s(e.headerTitle))])],1),e._v(" "),l("div",{staticClass:"breadbottom"}),e._v(" "),l("br"),e._v(" "),l("p",[l("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleAdd()}}},[e._v("添加")])],1),e._v(" "),l("br"),e._v(" "),l("div",{staticClass:"viewTableClass"},[l("el-table",{attrs:{data:e.viewTable.data,border:"","header-cell-style":{background:"#f9fafc"}}},[l("el-table-column",{attrs:{prop:"id",label:"ID",width:"100"}}),e._v(" "),l("el-table-column",{attrs:{prop:"columnName",label:"字段名",width:"100"}}),e._v(" "),l("el-table-column",{attrs:{prop:"jdbcType",label:"数据类型",width:"100"}}),e._v(" "),l("el-table-column",{attrs:{prop:"length",label:"数据长度",width:"100"}}),e._v(" "),l("el-table-column",{attrs:{prop:"name",label:"名称",width:"100"}}),e._v(" "),l("el-table-column",{attrs:{prop:"description",label:"说明"}}),e._v(" "),l("el-table-column",{attrs:{prop:"type",label:"类型",width:"100"}}),e._v(" "),l("el-table-column",{attrs:{prop:"disRes",label:"引用字典对象"}}),e._v(" "),l("el-table-column",{attrs:{prop:"rule",label:"规则",width:"100"}}),e._v(" "),l("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(l){e.handleEdit(t.row,t.$index)}}},[e._v("修改")]),e._v(" "),l("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(l){e.handleDelet(t.row,t.$index)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),l("el-dialog",{attrs:{title:"添加数据集属性",visible:e.viewAdd.show,width:"30%",id:"viewAdd"},on:{"update:visible":function(t){e.$set(e.viewAdd,"show",t)}}},[l("el-form",{attrs:{model:e.viewAdd.data,"label-position":"right","label-width":"120px"}},[l("selectObjAttr",{on:{listenDatasetAttrs:e._getDatasetAttrs}})],1),e._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{attrs:{type:"danger"},on:{click:function(t){e.viewAdd.show=!1}}},[e._v("取消")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addSingle()}}},[e._v("确定")])],1)],1),e._v(" "),l("el-dialog",{attrs:{title:"修改数据集属性",visible:e.viewEdit.show,width:"30%",id:"viewEdit"},on:{"update:visible":function(t){e.$set(e.viewEdit,"show",t)}}},[l("el-form",{attrs:{model:e.viewEdit.data,"label-position":"right","label-width":"120px"}},[l("el-form-item",{attrs:{label:"字段名："}},[l("el-input",{attrs:{placeholder:"请输入字段名"},model:{value:e.viewEdit.data.columnName,callback:function(t){e.$set(e.viewEdit.data,"columnName",t)},expression:"viewEdit.data.columnName"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"数据类型："}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.viewEdit.data.jdbcType,callback:function(t){e.$set(e.viewEdit.data,"jdbcType",t)},expression:"viewEdit.data.jdbcType"}},e._l(e.plugs.select1,function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),l("el-form-item",{attrs:{label:"数据长度："}},[l("el-input",{attrs:{placeholder:"请输入数据长度"},model:{value:e.viewEdit.data.length,callback:function(t){e.$set(e.viewEdit.data,"length",t)},expression:"viewEdit.data.length"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"名称："}},[l("el-input",{attrs:{placeholder:"请输入名称"},model:{value:e.viewEdit.data.name,callback:function(t){e.$set(e.viewEdit.data,"name",t)},expression:"viewEdit.data.name"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"说明："}},[l("el-input",{attrs:{placeholder:"请输入说明"},model:{value:e.viewEdit.data.description,callback:function(t){e.$set(e.viewEdit.data,"description",t)},expression:"viewEdit.data.description"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"类型："}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.viewEdit.data.type,callback:function(t){e.$set(e.viewEdit.data,"type",t)},expression:"viewEdit.data.type"}},e._l(e.plugs.select2,function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),l("el-form-item",{attrs:{label:"引用字典对象："}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.viewEdit.data.disRes,callback:function(t){e.$set(e.viewEdit.data,"disRes",t)},expression:"viewEdit.data.disRes"}},e._l(e.plugs.select3,function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),l("el-form-item",{attrs:{label:"规则："}},[l("el-input",{attrs:{placeholder:"请输入规则"},model:{value:e.viewEdit.data.rule,callback:function(t){e.$set(e.viewEdit.data,"rule",t)},expression:"viewEdit.data.rule"}})],1)],1),e._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{attrs:{type:"danger"},on:{click:function(t){e.viewEdit.show=!1}}},[e._v("取消")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:function(t){e.editSingle()}}},[e._v("确定")])],1)],1),e._v(" "),l("el-dialog",{attrs:{title:"删除",visible:e.viewDelet.show,width:"30%",id:"viewDelet"},on:{"update:visible":function(t){e.$set(e.viewDelet,"show",t)}}},[l("div",{staticClass:"modal-body"},[e._v("\n      您确定删除要删除该项吗?\n    ")]),e._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{attrs:{type:"danger"},on:{click:function(t){e.viewDelet.show=!1}}},[e._v("取消")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:function(t){e.deletSingle()}}},[e._v("确定")])],1)])],1)},staticRenderFns:[]},d=l("VU/8")(n,r,!1,null,null,null);t.default=d.exports}});
//# sourceMappingURL=3.925d4e8b66d6d004e095.js.map